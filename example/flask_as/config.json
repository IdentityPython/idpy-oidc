{
  "logging": {
    "version": 1,
    "root": {
      "handlers": [
        "default",
        "console"
      ],
      "level": "DEBUG"
    },
    "loggers": {
      "bobcat_idp": {
        "level": "DEBUG"
      }
    },
    "handlers": {
      "default": {
        "class": "logging.FileHandler",
        "filename": "debug.log",
        "formatter": "default"
      },
      "console": {
        "class": "logging.StreamHandler",
        "stream": "ext://sys.stdout",
        "formatter": "default"
      }
    },
    "formatters": {
      "default": {
        "format": "%(asctime)s %(name)s %(levelname)s %(message)s"
      }
    }
  },
  "port": 5000,
  "domain": "127.0.0.1",
  "server_name": "{domain}:{port}",
  "base_url": "https://{domain}:{port}",
  "entity": {
    "entity_id": "https://{domain}:{port}",
    "entity_type": {
      "oauth_authorization_server": {
        "class": "idpyoidc.server.Server",
        "kwargs": {
          "conf": {
            "add_on": {
              "pkce": {
                "function": "idpyoidc.server.oauth2.add_on.pkce.add_support",
                "kwargs": {
                  "essential": false,
                  "code_challenge_method": "S256 S384 S512"
                }
              }
            },
            "authz": {
              "class": "idpyoidc.server.authz.AuthzHandling",
              "kwargs": {
                "grant_config": {
                  "usage_rules": {
                    "authorization_code": {
                      "supports_minting": [
                        "access_token",
                        "refresh_token",
                        "id_token"
                      ],
                      "max_usage": 1
                    },
                    "access_token": {},
                    "refresh_token": {
                      "supports_minting": [
                        "access_token",
                        "refresh_token"
                      ]
                    }
                  },
                  "expires_in": 43200
                }
              }
            },
            "authentication": {
              "user": {
                "acr": "urn:oasis:names:tc:SAML:2.0:ac:classes:InternetProtocolPassword",
                "class": "idpyoidc.server.user_authn.user.UserPassJinja2",
                "kwargs": {
                  "verify_endpoint": "/verify/user",
                  "template": "user_pass.jinja2",
                  "db": {
                    "class": "idpyoidc.server.util.JSONDictDB",
                    "kwargs": {
                      "filename": "passwd.json"
                    }
                  },
                  "page_header": "Testing log in",
                  "submit_btn": "Get me in!",
                  "user_label": "Nickname",
                  "passwd_label": "Secret sauce"
                }
              }
            },
            "capabilities": {
              "subject_types_supported": [
                "public",
                "pairwise"
              ],
              "grant_types_supported": [
                "authorization_code",
                "implicit",
                "urn:ietf:params:oauth:grant-type:jwt-bearer",
                "refresh_token"
              ],
              "request_object_signing_alg_values_supported": [
                "RS256",
                "RS384",
                "RS512",
                "ES256",
                "ES384",
                "ES512",
                "HS256",
                "HS384",
                "HS512",
                "PS256",
                "PS384",
                "PS512"
              ]
            },
            "claims_interface": {
              "class": "idpyoidc.server.session.claims.ClaimsInterface",
              "kwargs": {}
            },
            "cookie_handler": {
              "class": "idpyoidc.server.cookie_handler.CookieHandler",
              "kwargs": {
                "keys": {
                  "private_path": "private/cookie_jwks.json",
                  "key_defs": [
                    {
                      "type": "OCT",
                      "use": [
                        "enc"
                      ],
                      "kid": "enc"
                    },
                    {
                      "type": "OCT",
                      "use": [
                        "sig"
                      ],
                      "kid": "sig"
                    }
                  ],
                  "read_only": false
                },
                "name": {
                  "session": "oidc_op",
                  "register": "oidc_op_rp",
                  "session_management": "sman"
                }
              }
            },
            "endpoint": {
              "server_metadata": {
                "path": ".well-known/openid-configuration",
                "class": "idpyoidc.server.oauth2.server_metadata.ServerMetadata",
                "kwargs": {
                  "client_authn_method": null
                }
              },
              "introspection": {
                "path": "introspection",
                "class": "idpyoidc.server.oauth2.introspection.Introspection",
                "kwargs": {
                  "client_authn_method": [
                    "client_secret_post",
                    "client_secret_basic",
                    "client_secret_jwt",
                    "private_key_jwt"
                  ],
                  "release": [
                    "username"
                  ]
                }
              },
              "authorization": {
                "path": "authorization",
                "class": "idpyoidc.server.oauth2.authorization.Authorization",
                "kwargs": {
                  "client_authn_method": null,
                  "claims_parameter_supported": true,
                  "request_parameter_supported": true,
                  "request_uri_parameter_supported": true,
                  "response_types_supported": [
                    "code",
                    "id_token",
                    "code id_token"
                  ],
                  "response_modes_supported": [
                    "query",
                    "fragment",
                    "form_post"
                  ]
                }
              },
              "token": {
                "path": "token",
                "class": "idpyoidc.server.oauth2.token.Token",
                "kwargs": {
                  "client_authn_method": [
                    "client_secret_post",
                    "client_secret_basic",
                    "client_secret_jwt",
                    "private_key_jwt"
                  ]
                }
              }
            },
            "httpc_params": {
              "verify": false
            },
            "issuer": "https://{domain}:{port}",
            "keys": {
              "private_path": "private/jwks.json",
              "key_defs": [
                {
                  "type": "RSA",
                  "use": [
                    "sig"
                  ]
                },
                {
                  "type": "EC",
                  "crv": "P-256",
                  "use": [
                    "sig"
                  ]
                }
              ],
              "public_path": "static/jwks.json",
              "read_only": false,
              "uri_path": "static/jwks.json"
            },
            "template_dir": "templates",
            "token_handler_args": {
              "jwks_file": "private/token_jwks.json",
              "code": {
                "kwargs": {
                  "lifetime": 600
                }
              },
              "token": {
                "class": "idpyoidc.server.token.jwt_token.JWTToken",
                "kwargs": {
                  "lifetime": 3600,
                  "add_claims": [
                    "email",
                    "email_verified",
                    "phone_number",
                    "phone_number_verified"
                  ],
                  "add_claims_by_scope": true,
                  "aud": [
                    "https://example.org/appl"
                  ]
                }
              },
              "refresh": {
                "kwargs": {
                  "lifetime": 86400
                }
              },
              "id_token": {
                "class": "idpyoidc.server.token.id_token.IDToken",
                "kwargs": {
                  "base_claims": {
                    "email": {
                      "essential": true
                    },
                    "email_verified": {
                      "essential": true
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "webserver": {
    "server_cert": "certs/client.crt",
    "server_key": "certs/client.key",
    "ca_bundle": null,
    "verify_user": false,
    "port": 5000,
    "domain": "127.0.0.1",
    "debug": true
  }
}
